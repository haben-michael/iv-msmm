\documentclass{beamer}
\usepackage{beamerthemesplit}
\usepackage{tikz}
\usepackage{ocgx2}
\usepackage{amsmath,amsthm,amssymb,amscd, graphicx,bbm,xcolor}
\usepackage{array}
\usepackage{etoolbox}
\usepackage{mathtools}
\usepackage{subfig}
\usepackage{multirow}
\DeclareMathOperator{\AUC}{AUC}
\DeclareMathOperator{\V}{Var}
\DeclareMathOperator{\cov}{Cov}
\DeclareMathOperator{\corr}{Corr}
\DeclareMathOperator{\sd}{sd}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\diag}{diag}
\DeclareMathOperator*{\logit}{logit}
\newcommand{\E}{E}
\renewcommand{\P}{P}
\newcommand{\cind}{\perp \!\!\! \perp}
\newcommand{\X}[1][]{X_{0#1}}
\newcommand{\Y}[1][]{X_{1#1}}
\newcommand{\W}[1][]{W_{#1}}
\newcommand{\w}[1][]{w_{#1}}
\newcommand{\z}[1][]{w_{#1}}
\newcommand{\D}[1][]{D_{#1}}
\renewcommand{\t}[1]{{#1}^T}
\renewcommand{\star}[1]{{#1}^\ast}
\newcommand{\infl}[1][]{\psi_{#1}}
\newcommand{\F}{F}
\newcommand{\G}{G}
% \newcommand{\D}{D}
\newcommand{\m}{m}
\newcommand{\n}{n}
\newcommand{\N}{m+n}
% \newcommand{\risk}{\rho}
\newcommand{\risk}[1][]{\rho_{#1}}
\newcommand{\auc}{\theta}
% \newcommand{\betastar}{\beta_0}
\newcommand{\aucdiff}{\Delta\text{AUC}}
\newcommand{\aucdiffhat}{\hat{\Delta\text{AUC}}}
\newcommand{\kernel}[2]{\{#1 < #2\}}
% \newtheorem{theorem}{Theorem}
\newtheorem{proposition}[theorem]{Proposition}
% \newtheorem{lemma}[theorem]{Lemma}
% \newtheorem{corollary}[theorem]{Corollary}

\setbeamertemplate{navigation symbols}{}
\newcommand{\PreserveBackslash}[1]{\let\temp=\\#1\let\\=\temp}
\newcolumntype{C}[1]{>{\PreserveBackslash\centering}p{#1}}
\graphicspath{{../manuscript/figs/}{../../1/ms/}}
% \graphicspath{{./figs/}}
\makeatletter
\def\input@path{{../manuscript/}}
% \graphicspath{{../../1/ms/}{../../1/ms/figs}}
% \graphicspath{{./figs/}}
\makeatother
\usetikzlibrary{calc}
\mathtoolsset{showonlyrefs=true}
\newtoggle{speaktoggle}
\toggletrue{speaktoggle}
\newcommand{\speak}[1]{
  \iftoggle{speaktoggle}{
    {\tiny{\textcolor{red}{speak: #1}}\normalsize}
  }
  {}
}
% \makeatletter
% \def\input@path{{../manuscript/}}
% % or: \def\input@path{{/path/to/folder/}{/path/to/other/folder/}}
% \makeatother\setbeamertemplate{footline}[frame number]

\title{Nonparametric Estimation of the AUC of an Index with Estimated Parameters}
\author{Haben Michael}
\date{February 2023}

\AtBeginSection[] 
{
  \begin{frame}<beamer>
    \frametitle{Outline} 
    \tableofcontents[currentsection]  
  \end{frame}
}

\begin{document}



\begin{frame}
  \titlepage
\end{frame}




% % 1. intro
% % motivating example [copy old]
% % define auc [copy old]
% % need generalization for this type of data--vectors of obs, and dependence pairwise bw case and control
% % example applications

% % 2. generalization of auc to cluster data

% % let xymn be a random vector with joint distr...
% % let psi denote the auc between control cluster i and case cluster j
% % a. with xymn and xymn being two ndependent draws from P, we define the population auc as:

% % this is the most commonly used generalization to clusters. analogues show up in the literature.

% % b. individualize trt--natl acad quote

% % c. present personalized and population auc side by side. the individualized auc is:
% % cc. ``Both the population and personalized AUC, like the usual AUC, are bounded between 0
% % and 1, 1
% % 2 represents poor discrimination, and distance from 1
% % 2 represents increasing discrim-
% % ination. However, they describe distinct measures of discrimination. It is possible for one
% % to be informative and therefore far from 1/2, while the other is non-informative, or close to
% % 1/2. Whereas the personalized AUC is the AUC of a typical cluster, the population AUC
% % is, setting aside ties in the data, the probability that a typical control observation in the
% % population is less than a typical case observation.''
% % d. propositions for population auc

% % e. estimators. individual auc is just an iid average.  pop est is
% % theta12(empirical). a little more complicated to analyze. previous analysis [obu] uses ratio estimator, mayb emention ends up with an asy variance estimator nearly same as jk and cite other work. not quite a
% % u-statistic. mention a benefit of this reserach was to clarify the
% % statistical model and asymptotics of the pop auc, which already shows
% % up in similar forms. cavest that m and n ge 0.

% % 3. illustrations. mention motivation was many biostaticians intuited that pop auc as more informative. on some level recognized there is an indvidual auc. goal of this work is to investigate when this is true, but also when they disagree.
% % a. simpsons paradox examples
% % a1. let the distribution of --
% % a2. the individ auc is-- [note simplifaction for later]. the pop auc is --
% % a3. [images]
% % b. causal inference examples

% % 4. simplifications when the cluster values are independent of the cluster sizes
% % a. as expected, if the within cluster auc order relation is constant for all pairs, can reduce to the m=n=1 case. [counter example when m,n not independent of x,y]
% % b. the population auc may bound the individual auc
% % b1. illustrate the interplay bw joint distr and marginals, in the m=n=1 case
% % b2. [give picture]


% % simulations
% % fpr
% % power

% % data application


% \section{Introduction}
% \begin{frame}
%   \centering
%   A motivating example
%   \medskip
%   \begin{columns}
%     \begin{column}{.3\textwidth}
%       Data: The Yale Prospective Longitudinal HIV Cohort
%       \vspace{.2in}
      
%       Problem: Evaluate CD4 as a predictor of blip status
%     \end{column}
%     \begin{column}{.7\textwidth}
%       \includegraphics[width=\textwidth]{fig5.png}
%     \end{column}
%   \end{columns}
  
%   % motivating example -- 
%   % \includegraphics[scale=.4]{fig5.png}
% \end{frame}
% \begin{frame}
%   \centering
%   \includegraphics[scale=.22]{fig4.png}
% \end{frame}
% \begin{frame}
%   \begin{columns}
%     \begin{column}{.5\textwidth}
%   \begin{tabular}{c | c | c}
%     & control & case\\
%     \hline&&\\
%     obs. \# 1 & $X_1$ & \\
%     \vdots & \vdots & \\
%     obs. \# k & $X_{k}$ &\\
%       obs. \# k+1 &  & $Y_{k+1}$\\
%      \vdots & & \vdots\\
%     obs. \# \I &  & $Y_{\I}$\\
%   \end{tabular}
% \end{column}
% \begin{column}{.5\textwidth}
%   The AUC is the probability that an observation drawn from a
%   negative/control/non-diseased subject is less than an independent
%   observation from a positive/case/diseased subject.
%   % $$\text{AUC}=\P(X < Y)=\E(F_X(Y))$$
%   % $$\widehat{\text{AUC}}=\frac{1}{k(\I-k)}\sum_{i,j}\{X_i<Y_j\}$$
%   $$\theta(P)=\P(X < Y)=\E(F_X(Y))$$
%   $$\hat{\theta}(\vec X,\vec Y)=\frac{1}{k(\I-k)}\sum_{i,j}\{X_i<Y_j\}$$
% \end{column}
% \end{columns}
% \end{frame}


% \begin{frame}
%   We wish to extend the AUC to clusters



%   \begin{itemize}
%   \item markers: longitudinal measurements of tumour antigens (CEA,
%     CA15-3, TPS), response: progression/non-progression of breast
%     cancer (Emir 2000)

%   % \item markers: two measurements of the distortion product
%   %   otoacoustic emissions taken from the left and right ears of each
%   %   patient, response: neonatal hearing impairment (Wu 2019)

%   \item markers: longitudinal measurements of levels of vascular
%     enothelial growth factor, % and a soluble fragment of Cytokeratin 19
%     response: progression/non-progression of non-small cell lung
%     cancer (Wu, Wang 2011)
%    \end{itemize}
%  \end{frame}

%  \begin{frame}
%   \centering
%   \begin{tabular}{c | c | c}
%     & control & case\\
%     \hline&&\\
%     obs. \# 1 & $(X_{11},\ldots,X_{1m_1})$ & $(Y_{11},\ldots,Y_{1n_1})$\\
%     \vdots & \vdots & \vdots\\
%     obs. \# \I & $(X_{\I1},\ldots,X_{\I m_{\I}})$ & $(Y_{\I1},\ldots,Y_{\I n_{\I}})$\\
%   \end{tabular}
%  \begin{itemize}
%   \item     Let $(X,Y,M,N)$ be a random vector
%     with joint distribution denoted $\P$
%   \item $X$ and $Y$ are vectors of control and case observations of lengths $M$ and $N$
%     % such that $X$ and $Y$ are sequences and $M$ and $N$ are counting numbers.%$X$ is a vector of length $M$
%     % and $Y$ is a vector of length $N$, where $M$ and $N$ are counting
%     % numbers.
%     % \begin{gather}
%     %   \begin{aligned}\label{model:cluster auc}
%     %     &(X,Y,M,N) \sim \P\\
%     %     &X=(X_1,X_2,\ldots)\in\mathbb{R}^\mathbb{N}, Y=(Y_1,Y_2,\ldots)\in\mathbb{R}^\mathbb{N}\\
%     %     &M,N \in 1,2,3,\ldots .
%     %   \end{aligned}
%     % \end{gather}
%   \end{itemize}
%   % think of x and y as vectors of length m and n
% \end{frame}

% \begin{frame}
%   With $(X_1,Y_1,M_1,N_1)$ and $(X_2,Y_2,M_2,N_2),$ being two independent draws from $P$, we define the population AUC as
%   \begin{gather}
%     \begin{aligned}
%       &\aucpop(\P)=\frac{\E\hat{\theta}(X_1,Y_2)}{\E(M_1)\E(N_2)}
%       = \frac{1}{\E(M_1)\E(N_2)}\E\left( \sum_{i=1}^{M_1}\sum_{j=1}^{N_2}\{X_{1i}<Y_{2j}\}\right)\\
%       &(X_1,Y_1,M_1,N_1),(X_2,Y_2,M_2,N_2) \overset{\text{IID}}{\sim} \P.
%     \end{aligned}
%   \end{gather}
%   % this parameter/the model appears to be implied by what the applied researchers have in mind
% \end{frame}

% \begin{frame}
%   \begin{itemize}
%   \item     the medical field has lately focused on
%     personalizing treatment
%   \item For example, in 2018 the National Academy of Medicine concluded: ``The
%     individuality of the patient should be at the core of every treatment
%     decision. One-size-fits-all approaches to treating medical conditions
%     are inadequate; instead, treatments should be tailored to individuals
%     . . .''
%   \end{itemize}
% \end{frame}

% \begin{frame}
%  Besides the population AUC
% $$      \aucpop(\P)=\frac{\E\hat\theta(X_1,Y_2)}{\E(M_1)\E(N_2)}
% $$
% we define the personalized AUC as:
% \begin{align}
%   \aucindiv(\P)=\E\left(\frac{\hat\theta(X_1,Y_1)}{M_1N_1} \right)
%   = \E\left(\frac{ \sum_{i=1}^{M_1}\sum_{j=1}^{N_1}\{X_{1i}<Y_{1j}\}}{M_1N_1} \right)\\.
%   \label{defn:aucindiv}
% \end{align}

% (Definition requires $M>0,N>0$.)


% \end{frame}

% \begin{frame}
%   \begin{itemize}
% \item Both the population and personalized AUC, like the usual AUC, are bounded between 0
% and 1, $1/2$ represents poor discrimination, and distance from 1/2 represents increasing discrimination.

% \item However, they describe distinct aspects of discrimination. % It is possible for one
% % to be informative and therefore far from 1/2, while the other is non-informative, or close to
% % 1/2.

% \item Whereas the personalized AUC is the AUC of a typical cluster, the population AUC
% is the probability that a typical control observation in the
% population is less than a typical case observation.
% \end{itemize}
% \end{frame}

% \begin{frame}
% \begin{proposition}
%   \label{proposition:aucpop}
%   \begin{enumerate}
%   \item Let $(X_1,Y_1,M_1,N_1),\ldots,(X_\I,Y_\I,M_\I,N_\I),$
%     be a random sample of size $\I$ IID according to $\P$. Let $\P_\I$ be
%     the joint distribution of independent random selections from
%     among the elements of $X_1,\ldots,X_\I,$ and $Y_1,\ldots,Y_\I$, and
%     let $(\xi_\I,\eta_\I)\sim\P_\I$. Then
%     $\theta(\P_\I)=Pr(\xi_\I<\eta_\I)+\frac{1}{2}Pr(\xi_I=\eta_I) \to \theta_{12}(\P)$
%     as $\I\to\infty$.
%   \item Let $(X_1,Y_1,M_1,N_1),\ldots,$
%     be an infinite random sequence sampled IID according to $\P$. Let $\P_\infty$ be
%     the joint distribution of independent random selections from
%     among the elements of $X_1,\ldots,$ and $Y_1,\ldots$, and
%     let $(\xi_\infty,\eta_\infty)\sim\P_\infty$. Then
%     $\theta(\P_\infty)=Pr(\xi_\infty<\eta_\infty)+\frac{1}{2}Pr(\xi_\infty=\eta_\infty)=\theta_{12}(\P).$    
%   \end{enumerate}
% \end{proposition}
% \end{frame}



% \begin{frame}
% An unbiased estimator of $\aucindiv$ is
% \begin{align}
%   \aucindivhat = \frac{1}{I}\sum_{i=1}^\I \frac{\hat\theta(X_i,Y_i)}{M_iN_i}. \label{defn:aucindivhat}
% \end{align}
% \end{frame}

% \begin{frame}
%   A consistent estimator of $\aucpop$ is
% \begin{align}
%   \aucpophat = \frac{\sum\sum_{i\neq j}\hat\theta(X_i,Y_j)}{\sum_iM_i\sum_iN_i}. \label{defn:aucpophat}
% \end{align}
% \begin{itemize}
% \item This is what shows up in the applied literature. Also some
% methodological work.\speak{Previous analysis [obu] uses ratio estimator. Ends up with an asy variance estimator nearly same as jk and [cite other work].} The definition of the population AUC was chosen in part as the
% plim of this statistic.


% \item Also $\theta_{12}(\text{empirical distribution of the clusters})+O(1/\I)$.

% \item  Almost but not quite a two-sample U-statistic.
% \end{itemize}
% % --this or similar seems to be the most commonly used generalization to clusters used by applied researchers

%   % --small methodological literature 

% % mention a benefit of this reserach was to clarify the
% % statistical model and asymptotics of the pop auc, which already shows
% % up in similar forms. 
% \end{frame}



% \section{Examples} 
% \begin{frame}
%   \begin{itemize}
%   \item random effects model
%   % Let the distribution of $(X,Y,M,N)$ given $M,N$ be
%   \begin{align}
%     X \mid M,N \sim Z(M,N) + \xi_i^x, i=1,\ldots,M\\
%     Y \mid M,N \sim Z(M,N) + \xi_j^y + \Delta, j=1,\ldots,N
%     \label{model:random effects}
%     % \xi\cind \xi', \Delta>0, \delta\in\mathbb{R}
%   \end{align}
%   \item $\Delta>0$ is a non-random location shift between the control and
%   case values

%   \item $Z$ is a random, cluster-level effect, inducing within-cluster dependence

%   \item $\xi_i^x, \xi_j^y,i=1,\ldots,M,j=1,\ldots,N,$ are IID
%   individual effects
% \end{itemize}
% % The within-cluster dependence is induced by
%   % $Z$. The individual effects $\xi_i^x, \xi_j^y$ are assumed to be
%   % independent of $(M,N)$, but $Z$ is not assumed to be so.
%   \speak{motivation was many biostaticians intuited that pop auc as more informative. on some level recognized there is an indvidual auc. goal of this work is to investigate when this is true, but also when they disagree.}
% \end{frame}
% \begin{frame}
% The personalized AUC is
% \begin{align}
%   \aucindiv 
%           % = \E \left(\frac{1}{M_1N_1} \sum_{i=1}^{M_1}\sum_{j=1}^{N_1}\{X_{1i}<Y_{1j}\}\right)\\
%           % &= \E\left( \frac{1}{M_1N_1} \sum_{i=1}^{M_1}\sum_{j=1}^{N_1}\{Z_1+\xi^x_i<Z_1+\xi_j^y+\Delta\}\right)\\
%           % &= \E \left(\frac{1}{M_1N_1} \sum_{i=1}^{M_1}\sum_{j=1}^{N_1}
%           %   \P(\xi_i^x-\xi_j^y<\Delta\mid M_1,N_1)\right)\\
%           &=\P(\xi_1 - \xi_2 < \Delta)\label{eqn:examples:aucindiv}
% \end{align}\speak{reduction to $M=N=1$ case}

% The population AUC is
% \begin{align}
%   \aucpop 
%           % &=\frac{1}{\E(M)\E(N)}\E \left(\sum_{i=1}^{M_1}\sum_{j=1}^{N_2}
%           %   \P(Z_1 + \xi^x < Z_2 + \xi^y + \Delta \mid M_1,N_1,M_2,N_2)\right)\\
%           % &=\frac{1}{\E(M)\E(N)}\E \left(M_1N_2
%           %   \P(Z_1 + \xi^x < Z_2 + \xi^y + \Delta \mid M_1,N_1,M_2,N_2)\right)\\
%           &=\E\left(\frac{M_1N_2}{\E(M)\E(N)} \{Z_1-Z_2 + (\xi^x-\xi^y)<\Delta\} \right)\label{eqn:examples:aucpop}
% \end{align}
% A covariance-like term lying between $0$ and $1$
% \end{frame}
% % a2. the individ auc is-- [note simplifaction for later]. the pop auc is --
% \begin{frame}
% \begin{figure}[!tbp]
%   \centering
% \includegraphics[width=0.49\textwidth]{220816a.pdf}
%   % \hfill
% \includegraphics[width=0.49\textwidth]{211223b.pdf}
% \end{figure}
% \small{rug plots of fifteen clusters of data, each cluster sampled IID
%     according to a binormal model, with the unclustered
%     data combined at the bottom. Case observations are represented with ``$-$'' and
%     control observations with ``$|$''}
                                
%     % --On the left, the personalized AUC is
%     % informative and the population AUC uninformative. The reverse situation is
%     % presented on the right
% \end{frame}


% \begin{frame}
%   \begin{itemize}
%     \item binary response model \speak{model disease status conditional on biomarkers rather than vice versa}
  
% \item  Fix the combined cluster size $M+N$% , let continuous cluster
%   % effects $Z$, continuous within-cluster effects $\xi$, and within-cluster
%   % status indicators $D$ specify the distribution of a cluster as follows:
%    \begin{gather}
%     \begin{aligned}
%       \text{individual effects }\vec{\xi}&=(\xi_1,\ldots,\xi_{M+N})\text{ IID}\\
%       \text{cluster effects } Z &\cind (\xi_1,\ldots,\xi_{M+N}) \\
%       \text{markers }B_i &= Z+\xi_i,i=1,\ldots,M+N\\
%       \text{case status indicators }\\
%       D_i \mid \vec{Z},\vec{\xi} &\sim \text{bernoulli with parameter } \sigma(\beta_0 Z+\beta_1\xi_i)\\
%       M = \sum_{i=1}^{M+N} (1-D_i),&\qquad     N = \sum_{i=1}^{M+N} D_i.
%     \end{aligned}
%   \end{gather}
% \item The control and case observations in a cluster, $X_i$ and $Y_i$, are $B_i$ such that $D_i=0$ and $D_i=1$
% \end{itemize}
% \end{frame}

% \begin{frame}
%   Suppose first that $\beta_0>0$ and $\beta_1=0$, so $$\P(D_i=1\mid  Z,\overline \xi)=\sigma(\beta_0 Z)$$
%   \begin{itemize}
%   \item The population AUC is
% \begin{align}
%   \aucpop % &=\frac{1}{\E M \E N}\E\left(\sum_{i=1}^{M+N}\sum_{j=1}^{N+N}\{B_{1i}<B_{2j}\}\{D_{1i}=0\}\{D_{2j}=1\}\right)\\
% 	&=\P(Z_{11}-Z_{21} < \xi_{21}-\xi_{11}\mid D_{11}=0, D_{21}=1)
% \end{align}
%  $Z_{11}\mid D_{11}=0$ is stochastically less than $Z_{21}\mid D_{21}=1$,% , with the difference increasing in $\beta_0$, % and since the $\xi$s are independent of the $Z$s and $D$s, 
%  the last line is $>\frac12$, with the difference increasing in $\beta_0$.

%  % On the other hand, $\vec{\xi}\cind (\vec{D},M,N),$ so
% \item The individual AUC is
% \begin{align}
%   \aucindiv % &= \E\left(\frac{1}{MN}\sum_{i=1}^{M+N}\sum_{j=1}^{M+N} \{B_{1i}<B_{1j}\}\{D_{i1}=0\text{ and }D_{ij}=1\}\mid M>0,N>0\right)\\
%   &=\P(\xi_{11}<\xi_{12})=1/2.
% \end{align}
% \end{itemize}
% \end{frame}
% \begin{frame}
%   Two possible instances of the model:
%   \begin{enumerate}%[label=(\alph*)]
%   \item The cluster effect $Z$ represents a genuine signal of disease
%     status $D$, such as viral load wrt HIV status, and $\xi$ represents
%     non-systematic measurement error on instruments measuring $Z$. In this
%     case, the population AUC better matches expectations of an AUC
%     measurement than the personalized AUC. The biomarker $B$ isn't
%     completely uninformative, as $\aucindiv$ suggests.
%   \item \label{item:example:threshold model:spurious} The cluster effect $Z$ is a subject's dose of a possibly ineffective drug,
%     and larger doses are administered to sicker patients. The subject-specific
%     measurements $\xi$ represent non-systematic measurement error
%     again. Here the association between the marker and disease status
%     implied by the population AUC is spurious, and may or may not be of
%     value to the analyst. It is possible that the personalized AUC, which
%     does not convey any association, is preferable.
%   \end{enumerate}
% \end{frame}

% \begin{frame}
%   Reversing the roles of the cluster-level effect $Z$ and within-cluster
%   effects $\xi$, suppose $\beta_0=0$ and $\beta_1>0$, so that $\aucpop\approx 1/2$ and
%   $\aucindiv>1/2$. Two instances of this model:
%   \begin{enumerate}%[resume,label=(\alph*)]
%   \item  The markers $B$ are measurements on a patient, 
%     $D$ indicates the presence of
%     a disease that depends little or not at all on a baseline measure $Z$ but is indicated by the deviations $\xi$ from the
%     baseline.  As a second example, the markers $B$ are post-test measurements on a population that has been stratified by pre-test measurement $Z$. The subject effects $\xi_i=B_i-Z$ represent the difference between post-test and pre-test measurements, and the status indicators $D$ represent an effective or ineffective intervention.
%     % such as glaucoma the status of which depends little or not at all on a baseline measure $Z$ cup-to-disc ratio.
%     Here the personalized AUC probably carries the correct interpretation.
%     % \comment{more concrete example? d=glaucoma, z=baseline cup-to-disc ratio, xi=devitiation from baseline.  second example: D=general inflammaion, Z=age, xi=Erythrocyte
%     % sedimentation rate. third example: D=obesity, Z=height,
%     % xi=weight.}
%   \end{enumerate}
% \end{frame}

% \begin{frame}
%   \begin{enumerate}
%     \setcounter{enumi}{1}
%   \item A population clustered along any given dimension $Z$, and, analogous to \ref{item:example:threshold model:spurious}, uptake of a possibly ineffective drug is confounded by indication. That is, sicker individuals, those for which $D_i$ is more likely to be $1$, take higher doses $\xi_i$ of the drug. Here again a causal analysis would suggest the population AUC as less misleading than the personalized AUC, though a non-causal analysis, e.g., an intention-to-treat analysis, may point to the personalized AUC.
%   \end{enumerate}
% \end{frame}
    


% \section{Reductions}
% \begin{frame}
% \begin{proposition}\label{proposition:reduction} Given
%   $(X,Y,M,N)\sim \P$, suppose 
%   that $\P(X_{1k}<Y_{1l}\mid M,N)$ and $\P(X_{1k}<Y_{2l}\mid M,N)$ do
%   not depend on $k,l$. Then $\aucindiv(\P)=P(X_{11}<Y_{11})$
%   and $\aucpop(\P)=P(X_{11}<Y_{21})$.
% \end{proposition}
% \end{frame}

% \begin{frame}
%   \begin{itemize}
%   \item In order for $\aucpophat\to 1$ while $\aucindivhat\not\to 1$ in the
%   random effects model, it
%   was necessary that $(X,Y)\not\cind (M,N)$.

% \item Consider a simpler result: For constant $M$ and $N$, does $\aucpop<\aucindiv$ hold?
  
% \item First consider a simple case where $M=N=1.$

% \end{itemize}

% \end{frame}

% \begin{frame}
%   Each cluster contributes
%   just one control and one case observation, and their joint
%   distribution $\P$ is supported on finitely many points in the
%   plane:  %regarding $\P$ as their joint distribution of $(X,Y)$, let this be a finite sum of atoms in the plane,
%   \begin{align}
%     &\P = \sum_{i=1}^\B p_i \delta_{(x_i,y_i)}\\
%     &(x_i,y_i) \in \mathbb{R}^2 \text{ and } 0\le p_i\le 1,i=1,\ldots,B\\
%     &p_1+\ldots+p_\B=1.
%   \end{align}
%   The personalized AUC is
%   $$\aucindiv(P)=\P(X<Y)=\underset{i:x_i<y_i}{\sum} p_i.$$
%   The population AUC depends on the product of the marginals  of $X$ and
%   $Y$
% \end{frame}

% \begin{frame}
% \begin{figure}[!tbp]
%   \centering
%   % \includegraphics[width=\textwidth]{220103.png}
% \begin{tikzpicture}[scale=1.3]
%   \def\xmin{-1}
%   \def\xmax{3}
%   \def\ymin{\xmin}
%   \def\ymax{\xmax}
%   \draw[->] (\xmin,0) -- (\xmax,0) coordinate (x axis);
%   \draw[->] (0,\ymin) -- (0,\ymax) coordinate (y axis);
%   \draw (\xmin+.5,\ymin+.5) -- (\xmax,\ymax);
%   \node (origin) at (0,0) {};
%   \node (A) at (\xmax-1,\ymax-.3 ) {\textbullet $p_1$};
%   \node (B) at ($ (A) - (.8,.4)$) {\textbullet $p_2$};
%   \node (C) at ($ (A) - (1.3,1.5)$) {\textbullet $p_3$};
%  \foreach \startpoint [count=\i] in {(origin),(A),(B),(C)}{
%    \foreach \endpoint [count=\j] in {(origin),(A),(B),(C)} {
%      \ifnum \i < 5
%      \ifnum \j < 5
%      \draw[dotted] \startpoint -| \endpoint ;
%      % \draw[dashed] \endpoint -- \endpoint |- \startpoint;
%      % \draw[dashed] \startpoint -| \endpoint -- \endpoint;
%      \fi
%      \fi
%       }
%     }
%   \end{tikzpicture}
% \end{figure}
% \footnotesize{  The
%     distance between the atoms $p_1$ and $p_2$ is small relative to
%     their distances to the line $x=y$, so they contribute
%     $(p_1+p_2)^2$ to the mass of $\{x<y\}$ under the product of the
%     marginals. The distance between $p_1$ and $p_3$ is relatively
%     large, so they contribute only
%     $(p_1+p_3)^2-p_1p_3$.}
% \end{frame}

% \begin{frame}
% When $M=N=1$,
% \begin{align}
%   1-\sqrt{2(1-\aucpop)} \le \aucindiv \le \sqrt{2\aucpop}.
% \end{align}
% or equivalently,
% \begin{align}
%   \frac{1}{2}\aucindiv^2 \le \aucpop \le 1 - \frac{1}{2}(1-\aucindiv)^2,\\
% \end{align}

% \begin{itemize}
% \item When the personalized AUC is completely uninformative, $\aucindiv=1/2$,
% the informativity of the population AUC is limited,
% $1/8 \le \aucpop \le 7/8$.
% \item However, when the population AUC is
%   completely uninformative, $\aucpop=1/2$, the above bounds on the personalized AUC, which are tight, are vacuous, $0\le\aucindiv\le 1$.
% % \item Situations where the population AUC $\to 1$ while the personalized AUC $\to 1/2$, may require some dependence between $M,N$ and $X,Y$
% \end{itemize}
% \end{frame}

% \begin{frame}
%   % In general, when $M$ and $N$ are each constant,
%   \begin{theorem}\label{theorem:bounds}
%     Let $(X,Y,M,N)\sim \P$ with $M=m$ and $N=n$  constant. Then
%     \begin{align}
%       \frac{1}{2}&\left(\aucindiv+\frac{\sum_{k,l}\P(X_{1k}=Y_{1l})}{2mn}\right)^2 \le \aucpop \\
%       &\le 1-\frac{1}{2}\left(1-\aucindiv+\frac{\sum_{k,l}\P(X_{1k}=Y_{1l})}{2mn}\right)^2      
%     \end{align}
%     % [[drop 1 and 2 from X/Y observations in favor of primes throughout?]]
%   \end{theorem}
%   \begin{itemize}
% \item Situations where the population AUC $\to 1$ while the personalized AUC $\to 1/2$, may require some dependence between $M,N$ and $X,Y$
% \end{itemize}
% \end{frame}

% \section{Estimation}
% \begin{frame}
%  Let $\psi:V\times V\to\mathbb{R}$, $W=(X,Y,M,N)\sim\P$ with $(X,Y)\in V\times V$, $\psi\in L^2(\P)$, $M$ and $N$ counting numbers $> 0$ with finite means. Then:
%   \begin{align}
%     \sqrt{\I}(\aucpophat-\aucpop,\aucindivhat-\aucindiv) \leadsto \mathcal{N}(0,\Sigma)
%   \end{align}
%   with
%   {\small
%   \begin{align}
%     \Sigma_{11} &= \lim_{\I\to\infty} \I\V(\hat\aucpop) =
%     \E\left(\frac{\E(\Kernel_{12}\mid\W{1})+\E(\Kernel_{21}\mid\W{1})}{\E M\E N} - \aucpop\left(\frac{M_1}{\E M} + \frac{N_1}{\E N}\right)   \right)^2
%     \\
%     \Sigma_{22} &= \lim_{\I\to\infty} \I\V(\hat\aucindiv) =
%     \V(\Kernel_{11}/(M_1N_1))
%     \\
%     \Sigma_{12} &= \lim_{\I\to\infty} \I\cov(\hat\aucpop,\hat\aucindiv) =
%     \aucpop\E\left(\frac{\Kernel_{11}}{M_1N_1}\left(\frac{\Kernel_{12}+\Kernel_{21}}{\E\Kernel_{12}} - \frac{M_1}{\E M}-\frac{N_1}{\E N}  \right) \right)
%   \end{align}
% }  
%   % $\sqrt{\I}(\aucpophat-\aucpop,\aucindivhat-\aucindiv) $ converges to a mean-zero bivariate normal distribution with covariance matrix given by
%   % \begin{align}
%   % \end{align}
% % \end{theorem}
% \end{frame}

% \begin{frame}
%   Simulation


%   \begin{itemize}
%   \item $M$ and $N$ are sampled as the negative and positive values in a correlated normal sample.
%   \item The greater the correlation, the greater the imbalance between
%     case and control observations within the clusters
%   \end{itemize}
% \end{frame}
% \begin{frame}
%   Two models for the observation vectors $(X,Y)$
%   \begin{itemize}
%   \item binormal model:
%     \begin{align}
%   (X,Y) \mid (M,N) \sim \mathcal{N}_{M+N}\left(
%   % \begin{pmatrix}\mu_X\mathbbm{1}_M\\ \mu_Y\mathbbm{1}_N\end{pmatrix},
%     \begin{pmatrix}0\cdot\mathbbm{1}_M\\ \Delta\cdot\mathbbm{1}_N\end{pmatrix},
%             \begin{pmatrix} 1 & \rho & \cdots & \rho\\
%               &\ddots &\ddots\\
%               \rho & \cdots & \rho &1
%             \end{pmatrix}
%             \right)
% \end{align}
% \item   $\aucpop(P) = \Phi\left(\frac{\Delta}{\sqrt{2}}\right), \aucindiv(P) =  \Phi\left(\frac{\Delta}{\sqrt{2(1-\rho)}}\right)$
% \item Censored binormal model: Sample $(\overline X,\overline Y)$, then clip the observations to $\pm a$


% \end{itemize}
% \end{frame}


% \begin{frame}
%   \begin{itemize}
% \item Empirical power function of the test of $H_0:\aucpop=\aucindiv$ versus $\aucpop<\aucindiv$ using the
% asymptotic estimator
% \item  same as $H_0:|\aucpop-1/2|=|\aucindiv-1/2|,$ equal informativity
%   \item normal data with and without clipping
% \end{itemize}
% \begin{figure}%[!tbp]
%   \centering
%   \subfloat{\includegraphics[width=0.5\textwidth]{../sim/220813/a/220813.pdf}}
%   \hfill
%   \subfloat{\includegraphics[width=0.5\textwidth]{../sim/220813/b/220813.pdf}}
%   % \caption{}  \label{fig:power}
% \end{figure}
% \end{frame}


% \section{Application}
% \begin{frame}
%   \begin{itemize}
%   \item  The data consists of Terry stops in New York City and Boston.
%   \item The analysis here focuses on the relationship between the duration of the
%     stop and race of the suspect.
%   \item We cluster the stops according to
%     precinct, in the case of NYC, and according to the officer conducting
%     the stop, in the case of Boston.
%   \end{itemize}
% \end{frame}

% % begin{frame}
% %     dkd
% %   }
% % \end{frame}

% \begin{frame}
%   \begin{table}
%     % \resizebox{3cm}{!}{
%     \small
%     \addtolength{\tabcolsep}{-5pt}
%     % \input{220823.tex}       
% \begin{tabular}{|l||C{2cm}|C{1cm}|C{1cm}||C{2cm}|C{1cm}|C{1cm}|}
%   \hline
%   & \multicolumn{3}{c||}{NYC} & \multicolumn{3}{c|}{Boston}\\
%  \hline
%  \hline
%  group & mean duration (SD) & count & freq. & mean duration (SD) & count & freq.\\
%  \hline
% Asian & 14.24 (21.16) & 1139 & 0.02 & 25.00 (24.22) & 53 & 0.01 \\ 
%   Black Hispanic & 11.01 (17.12) & 4675 & 0.09 & 15.28 (18.73) & 391 & 0.06 \\ 
%   Black non-Hispanic & 10.99 (16.78) & 31588 & 0.58 & 19.06 (28.93) & 3448 & 0.55 \\ 
%   White Hispanic & 11.21 (15.15) & 11486 & 0.21 & 15.63 (15.96) & 578 & 0.09 \\ 
%   White non-Hispanic & 12.85 (16.18) & 4854 & 0.09 & 21.74 (33.01) & 1760 & 0.28 \\ 
%   other & 11.84 (17.70) & 261 & 0.00 & 20.89 (23.90) & 93 & 0.01 \\ 
%    \hline
% \end{tabular}
%     \caption{Summary estimates on the duration of Terry stops by racial group.\speak{boston data has black/white without hispanic coded; here blacks where ethnicity is not recorded or NA are grouped as black non-hisp. maybe do alternative analysis where those are all NA'd. boston data puts south asian with middle eastern, which is other here.}\speak{in the boston data about [[]] of the black or whtie observations have no recorded hispanic/non-hispanic status.}}
% %}    % \label{table:data analysis:summary estimates}
% \end{table}
% \end{frame}

% \begin{frame}
%   $\aucpop < \aucindiv$
% \begin{itemize}
%   \item With Black race as the
%   binary classification, the AUC analysis looks for a difference in
%   location between the distribution of stop durations of non-Black
%   (``control'') and Black (``case'') suspects.

%   \item For the NYC data, the
%   population AUC estimate is
%   $\aucpophat=\input{input/da_black_nyc_theta12_mean.txt}$ with 95\%
%   CI \input{input/da_black_nyc_theta12_CI.txt}\unskip, significantly
%   different from the null value of $1/2$. The personalized AUC
%   estimate is
%   $\aucindivhat=\input{input/da_black_nyc_theta11_mean.txt}$ with a
%   95\% CI \input{input/da_black_nyc_theta11_CI.txt}.

%   \item A test of
%   equality $H_0:\aucpop=\aucindiv$ against $\aucpop < \aucindiv$ returns a p-value of $.05\%$. The
%   Boston data is similar.%  The population AUC estimate is
%   % \input{input/da_black_boston_theta12.txt} and the personalized AUC estimate
%   % is \input{input/da_black_boston_theta11.txt}. A test of equality
%   % $H_0:\aucpop=\aucindiv$ against $\aucpop < \aucindiv$ returns the p-value $.91\%$. Confidence
%   % ellipses are plotted in Figure \ref{fig:data analysis:confidence
%   % ellipses}.
% \end{itemize}
% \speak{  
%   The data recalls the situation depicted in
%   Fig. \ref{fig:comparison:b}, though of course the difference between
%   the two AUCs is less dramatic here than in the artificial example
%   constructed there.
% }
% \end{frame}

% \begin{frame}
%   \centering
%   \includegraphics[width=0.5\textwidth]{220823_nyc.pdf}
%   \end{frame}
  
% \begin{frame}
%   $\aucindiv < \aucpop$

%   \begin{itemize}
%     \item For the Boston data, the personalized
%   AUC, \input{input/da_white_boston_theta11.txt}\unskip, is more
%   informative than the population AUC,
%   \input{input/da_white_boston_theta12.txt}\unskip,
%   \item the test of
%   equality versus $\aucindiv < \aucpop$ returning a p-value of
%   % \input{input/da_white_boston_pval.txt}
%   2.5\%.
% \end{itemize}
% \speak{This
%   analysis therefore corresponds to the situation in...}
% \end{frame}

% \begin{frame}
%   No significant difference between $\aucpop$ and
%   $\aucindiv$.
% \begin{itemize}
%   \item duration of the stop between
%   non-Hispanic (``control'') and Hispanic (``case'') suspects: For both the NYC and Boston data, neither the population AUC nor
%   personalized AUC is significantly different from the null value
%   $1/2$, and the test of equality of the two AUCs fails to reject.

% \item For the Boston data, whether one takes the case status to be
%   non-Hispanic Black or non-Hispanic White, the two AUCs are
%   statistically indistinguishable from each other and each is
%   indistinguishable from the null value $1/2$.
% \end{itemize}
% \speak{many other examples since this is the null situation}
% \end{frame}

% \begin{frame}
%   Haben Michael, Lu Tian. The Population and Personalized AUCs. Forthcoming. Available at: \texttt{https://haben-michael.github.io/}\\
%   \vspace{.7in}
%   \centering
%   \huge THANK YOU
% \end{frame}


\section{Background/Motivation}
\begin{frame}
  \begin{itemize}

  \item medical professionals want to use biomarkers to classify
patients. combine several characteristics. usually linear combination
(``index'').

\item e.g., Framingham risk score for 10-year risk of cardiovascular disease, using as covariates  age, sex, LDL cholesterol, HDL cholesterol, blood pressure, diabetes, and smoking. \speak{sand
  ATP III models for 10-year risk of cardiovascular outcomes, Gail model for 5-year risk of
  breast cancer framingham heart score to ((check the purpose in demler)), which
includes smoker status, systolic bp etc.}
  \item Used for policy, insurance etc. \speak{take on a life of their own.  }
\end{itemize}
\end{frame}

% \begin{frame}

%   \begin{itemize}
%   \end{itemize}
% \end{frame}

\begin{frame}

  \begin{itemize}
  \item A good biomarker discriminates well between cases and controls:
    $$P(\beta^T \X < \beta^T \Y),$$
    $\X$ and $\Y$ being independent control and case observations  

  \item Always looking for new indexes. Compare indexes using the difference of AUCs. Typically nested: comparing a known index with another containing an additional covariate.
    $$P(\gamma^T (\X,\X') < \gamma^T (\Y,\Y')) - P(\beta^T \X < \beta^T \Y)$$
\end{itemize}
\end{frame}

\begin{frame}
  Procedure:
  \begin{enumerate}
\item Fit risk models to get coefficients, e.g., $P(\D=1 | \W)=\t\beta \W,P(\D=1 | \W,\W')=\t\gamma (\W,\W')$, to get coefficients $\hat\beta,\hat\gamma$.
\item Then compare observed AUCs
\begin{align}
(\m\n)^{-1} \sum_{i,j}\{\hat\gamma^T (\X,\X')_i < \hat\gamma^T (\Y,\Y')_j)\} \\- (\m\n)^{-1}\sum_{i,j}(\hat\beta^T \X[i] < \hat\beta^T \Y[j]\}
\end{align}
\end{enumerate}
Formal test is given in Delong '88.
% \speak{maybe give citations here. what is the relationship between the coef significance and significance of delong test?}
\includegraphics[width=\textwidth]{delong.png}
\end{frame}

\section{Problem}
\begin{frame}

  In the 2000s medical professionals noticed significantly different
  coefficient vectors don't lead to significantly nonzero $\aucdiff$
\begin{footnotesize}
  \begin{itemize}
\item Meigs JB et al. Genotype score in addition to common risk factors for
prediction of type II diabetes. New England Journal of Medicine. 2008; 359(21):2208–2219.

\item Wang TJ et al. Multiple biomarkers for the prediction of
first major cardiovascular events and death. The New England Journal of Medicine. 2006;
355(25):2631–2639.

\item Kattan MW. Judging new markers by their ability to improve predective accuracy. Journal of the
National Cancer Institute. 2003;

\item Cook NR. Statistical evaluation of prognostic versus diagnostic models: Beyond the ROC curve.
Clinical Chemistry. 2008;

\item Hlatky MA et al. Criteria for evaluation of novel markers of cardiovascular risk: A
scientific statement from the american heart association. Circulation. 2009

% \item Cook NR. Use and misuse of the receiver operating characteristics curve in risk prediction.
% Circulation. 2007
\end{itemize}
\end{footnotesize}
Leading some to question the difference in AUC as a useful criterion
\begin{footnotesize}
  \begin{itemize}
\item Tzoulaki I, Liberopoulos G, Ioannisis JPA. Assessment off claims of improved prediction beyond
the Framnigham risk score. JAMA. 2009
\end{itemize}
\end{footnotesize}
\end{frame}

\begin{frame}
By the early 2010s the issue comes to the attenton of biostatisticians 

\vspace{.1in}
\includegraphics[width=\textwidth]{seshan1}
\includegraphics[width=\textwidth]{seshan2}
% quotes from seshan. ''the baffling observation that use of the
% AUC test to compare nested binary regression models is invalid''
% ``The performance of the AUC test has perplexed other investigators''
\begin{columns}
  \begin{column}{.5\textwidth}
\begin{itemize}
\item Demler, Pencina, D'agonstino 2012: Simulation suggests nested null comparison leads to a degenerate U-stat, non-normal limiting distribution. Not contemplated by Delong's test.
\end{itemize}
\end{column}
\begin{column}{.5\textwidth}
  \includegraphics[width=\textwidth]{histogram}
\end{column}
\end{columns}
\end{frame}

\begin{frame}
  \begin{itemize}
\item Seshan, G\"onen, Begg 2013: principal issue is that the observations aren't iid due to the estimated coefficients, violation of the Delong test assumptions

\item Demler, Pencina, Cook, D'agonstino 2017: theoretical arguments
  that the principal issue is degeneracy of the U-statistic
  
\end{itemize}
\end{frame}

\begin{frame}
  Some solutions appear
\begin{itemize}
\item Demler 2011: With gaussian covariates and coeffiicents estimated by LDA or logistic regression, the null of $\aucdiff=0$ is the same as testing for equal Mahalonobis distances, can use an F-test

\item Pepe 2013: the null $\aucdiff=0$ is the same as the risk functions being equal $P(\D=1\mid \W,\W')=P(\D=1\mid \W)$

\item Heller 2017: obtain asymptotic distributions in case coefficient estimation procedure is MRC
\end{itemize}
However,
\begin{itemize}
\item Lee 2021: ``To date, it is remarked that
the asymptotic null distribution of the test statistic computed via the most commonly used MLE of binary
regression parameters is still considered as mathematically intractable in general. At least, Monte Carlo methods
are deemed to be infeasible or otherwise impractical . . .''
\end{itemize}
\end{frame}

\section{Proposed solution for the alternative}

\begin{frame}
  \begin{itemize}
    \item Focus first on the alternative first $\aucdiff\neq 0$: mainly for developing CIs for $\aucdiff$, rather than testing $H_0:\aucdiff=0$


\item Not much advantage gained from the full/reduced relationship
  between the two indexes. Just get an linearization representation for an index
AUC with estimated coeficient, then take difference.
\end{itemize}
\end{frame}

\begin{frame}
  \begin{itemize}
\item strategy in establishing asymptotic normality of U-statistics is to find an asymptotically
equivalent IID representation.

\item In the context of U-statistics usually known
as the hoeffding decomposition. dates to 1940s/50s

% \item ((vander vaart image of hoeffding decomp of mann-whitney))
\end{itemize}
\vspace{.1in}
\includegraphics[width=\textwidth]{vdvaart}
\end{frame}

\begin{frame}
 Delong '88: substitute empirical CDFs

  
  \speak{, though not described this
straightforwardly. but important to know that
it's doing the same thing: take a mean, plug in estimators, plug ins
just need to be consistent. will need this: estimating derivative of
estimated function is slow.((then why cant subsitute betahat into hoeffding decomp? that would be an asy estimator of $\theta(\hat F,\hat G,\beta) - \theta(F,G\beta)$.}
\end{frame}


\begin{frame}
Two sources of approximation. IID representation consists of the classical delong rep and an adjustment.

\begin{align}
  &\auc(\hat\F,\hat\G,\hat\beta) - \auc(\F,\G,\star\beta)\\
  &=\auc(\F+\delta\F,\G+\delta\G,\star\beta+\delta\beta) - \auc(\F,\G,\star\beta+\delta\beta) \\
    &+ \auc(\F,\G,\star\beta+\delta\beta)-\auc(\F,\G,\star\beta)
\end{align}
Where \begin{align}
  \auc(F,G,\beta) &= \int\kernel{\t\beta x}{\t\beta y}dF(x)dG(y).
\end{align}
and $\delta\F=\hat\F-\F,$ etc.
\end{frame}

\begin{frame}
\begin{proposition} Given a sample
  $(\W[1],\D[1]),\ldots,(\W[\N],\D[\N])$, and estimator
  $\hat\beta$ based on the sample.
  Assumptions:
  \begin{enumerate}
  \item available influence function for
    $\hat\beta$
  \item $P(\D=0) \in (0,1)$
  \item $\hat\beta\to\star\beta$
  \item   $\auc(\F,\G,\cdot)$ is differentiable at $\star\beta$
  \end{enumerate}
  Assertion:
  $(\N)^{-1/2}(\auc(\hat\F,\hat\G,\hat\beta)-\auc(\F,\G,\star\beta))$
  is asymptotically normal with mean zero, variance can be estimated using the linearization%  with mean zero and variance given by the
  % variance of a term in . This variance may be consistently
  % estimated as $\sqrt{\N}$ times the sample variance of the terms in
  % \eqref{method:iid representation}.
\end{proposition}
% ((add adjustment term somewhere, like the hajek term above??))
% ((mention somewhere derivative needs to be estimated nonparametrically))
In practice, requires non-parametric estimation of a gradient
\end{frame}


\begin{frame}
  \speak{looking for applications of the proposition}
Example: Linear discriminant analysis, but misspecified in that the classes may have different variances
\begin{gather}
  \begin{aligned}
    \W | \D=d \sim N_p(\mu_d,\Sigma_d), d=0,1\\
    \P(\D=1)=1-P(\D=0)=\pi_1
  \end{aligned}
\end{gather}
\end{frame}

\begin{frame}
  A sub-model
  \begin{align}
    % \Sigma_0 = \diag(\epsilon\cdot\mathbbm{
    \Sigma_0=\begin{pmatrix}
      \ddots & & & &\\
      & \epsilon & & & &\\
      & & \ddots & & &\\
      & &  & 2-\epsilon& &\\
      & &  & & \ddots&
    \end{pmatrix},
    \Sigma_1=I,
    \beta=\sqrt{2/p}\mathbbm{1}
  \end{align}
The adjustment term is
  \begin{align}
    |\Sigma_{\pi}^{-1/2}\frac{\partial}{\partial\beta}\auc(\F,\G,\beta)|
    &= \left|\frac{(\pi_1-\pi_0)(1-\epsilon)}{4\sqrt{p\pi\text{e}}}
      \begin{pmatrix}
        \vdots\\
        \pm( 1+(\epsilon-1)\pi_0)^{-1/2}\\
        \vdots        
      \end{pmatrix}\right|
  \end{align}
  which $\to\infty$ as $\pi_0\to 1$ and  $\epsilon\to 0$ simultaneously
\end{frame}

\begin{frame}
\includegraphics[scale=.5]{../sim/lda/sim}
\end{frame}


\begin{frame}
- - logistic example: regular delong estimator OK. LDA well specified: regular delong estimator OK. ((plots))
\end{frame}

\begin{frame}
Why was it so hard to find useful applications of the proposed estimator?
  \begin{columns}
    \begin{column}{.7\textwidth}
\begin{enumerate}
\item the adjustment term is a taylor expansion, the derivative of the AUC at the true coefficient values
%((reproduce adjustment))

\item given covariates $\W$, the ROC curve of the likelihood ratio $w\mapsto f_{\W\mid\D=1}(w)/f_{\W\mid\D=0}(w)$, is at every point maximal \speak{no other ROC curve based on $\W$ exceeds it}

\item the AUC of the likelihood ratio is a stationary point

\item the AUC is invariant to increasing transformations of the data
\end{enumerate}


    \end{column}
    \begin{column}{.3\textwidth}
      % \begin{tikzpicture}
      %   \node[shape=circle,draw=black,font=\tiny] (A) at (0,0) {$NM$};
      %   \node[shape=circle,draw=black,font=\tiny] (Y) at (2,0) {$performance$};
      %   \node[shape=circle,draw=black,font=\tiny] (L) at (1,2) {$talent, etc.$};
      %   \node at (2,1.2) {90\% ?};

      %   \draw [-latex] (A) to [bend left=0] (Y);
      %   \draw [-latex] (L) to [bend left=0] (Y);
      %   \draw [-latex] (L) to [bend left=0] (A);
      % \end{tikzpicture}
\includegraphics[width=\textwidth]{roc.png}
      
    \end{column}
  \end{columns}
  % \medskip
  % Blazer's edge analyst:  ``No satisfactory conclusions can be found in the realm of `what if'''


\end{frame}


% \begin{frame}
% Why was it so hard to find useful applications of the proposed estimator?

% \begin{enumerate}
% \item the adjustment term is a taylor expansion, the derivative of the AUC at the true coefficient values
% %((reproduce adjustment))

% \item given covariates $\W$, the ROC curve of the likelihood ratio $P(\D=1\mid \W=\w)/P(\D=0\mid \W=\w)$ is at every point maximal; no other ROC curve based on $\W$ exceeds it

% \item the AUC of the likelihood ratio is a stationary point

% \item the AUC is invariant to increasing transformations of the data
% \end{enumerate}

% \end{frame}

\begin{frame}
Binary index model example 
$$ P(\D=1\mid \W) = h(\t\beta \W), \text{$h$ increasing} $$
$$ P(\D=1\mid \W) = \text{expit}\log(P(\D=1\mid \W=\w)/P(\D=0\mid \W=\w)) $$

 so index AUC needs no adjustment
\end{frame}

\begin{frame}
  \begin{itemize}
\item But, there are two AUCs involved in $\aucdiff$% . Even if $...$, the reduced model wouldn't usually be well-specified

\item In many cases correctness of the full
model,
\begin{align}
    \P(\D=1\mid(\W,\W')=(\w,\w')) = h(\t\beta (\w,\w'))\\ \text{ for some }\beta\in\mathbb{R}^{p+q}
\end{align}
implies the reduced model cannot be correct
\begin{align}
  \P(\D=1\mid \W=\w)=\E(h(\t\beta (\w,\w'))\mid \w)\neq h(\t\beta \w)\\ \text{ for any }\beta\in\mathbb{R}^p.
\end{align}
\end{itemize}
\end{frame}

\begin{frame}
 would for a model such as the probit with gaussian data. then the
logistic model is similar, thre is an adjustment but boils down to
difference between expit and normal CDF. ((maybe give plot. asy
behavior quite different. result: for any link, if the data is
gaussian, then the adjustment term only vanishes for the probit
coefficients.))

\end{frame}

\begin{frame}
\end{frame}

\begin{frame}
\end{frame}

\begin{frame}
\end{frame}



- - slide(s) giving list of key papers starting in 2011
should note: non iid observations. degeneracy under the null. show picture.
bootstrap doesnt seem to do well either (maybe a pic of issues). ``perplexing'' etc.




% demler 2011: for lda/logistic regr with normal covariates, testing for improvmenet in discriminaiton is the same as testing for a significants in the coef procedure

% pepe 2013: more generally, can just test if risk functions of the two models are different. null of no diff of risks is the same as null of no diff of aucs.



- proposed solution under alternative



- - write out proposition, along with assumptions.

- - then search for where to apply it




- - collapsibility-type


% monotonic transformatons of likelihood/neyman-pearson. to risk maximized as
% an explanation for why the delong statistic works in many situations.
% auc derivative is maximized when model is well specified,
% for many common models.

% collapsible-type models 

- null situation

- - nonnormal limit but in some ways null case is simpler. no need for
functional derivative, const terms cancel. can pretransform data with many coef estimation
procedures.

- - nonparametric estimation of a hessian

- - key difficulty in the null situation: normal limit if coef
estimation procedure is misspecified; nonnormal if well-specified. explain in terms of expansion. is there a boundary, where the coef model is nearly misspecified?
\end{document}
